HR por Lieby Cardoso
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Carregue aqui todos os pacotes utilizados 
# na sua anÃ¡lise realizada neste arquivo fonte.

# Note que o parÃ¢metro "echo" foi definido como FALSE neste cÃ³digo.
# Isso previne que o cÃ³digo apresente resultados formatados em HTML.
# VocÃª deve definir echo=FALSE para todos os blocos de cÃ³digo no seu arquivo.

library(ggplot2)

library(ggthemes) 

# Cria objetos gráficos e posiciona em uma página
library(gridExtra)

# Facilita a limpeza dos dados spread() & gather()
library(tidyr)

# Manipulação de dados
library(dplyr)

# Templates adicionais do ggplot2
library(GGally)

#library(maptools)

library(corrplot)
library(formattable)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
#library(scales)
library(memisc)
library(lattice)
library(MASS)
library(car)
library(reshape)
library(plyr)
```


```{r echo=FALSE, Load_the_Data}
# Carregamento dos dados

hr <- read.csv('P:/Nanodegree/P04_Explore_Summarize/Explore_Summarize_R/HR_data.csv', sep = ',', na.strings=c("","NA"))
names(hr)

```

```{r}
setwd("C:/Nanodegree/Explore_Summarize")
state.map <- readShapeSpatial("estados_2010.shp")
counties.map <- readShapeSpatial("municipios_2010.shp")
## this is the variable we will be plotting
counties.map@data$noise <- rnorm(nrow(counties.map@data))
```


```{r}
str(hr)
```
```{r}

```

```{r}
```

```{r}
# Verifica o total de valores nulos no campo de percentual de financiamento concedido que é o mais foco principal

```
```{r}
summary(hr)

```
```{r}
fies$IDADE = as.numeric(round(difftime(Sys.Date(), fies$DT_NASCIMENTO)/365))
```

```{r}
# Verifica o total de NA em cada campo
for (i in 1:9) {
  print (paste(names(hr[i]) , sum(is.na(hr[i])), sep="="))
  next
  
}
```


```{r echo=FALSE, Univariate_Plots}
# Exclui os regitros com NA
fies <- fies[complete.cases(fies),]
```



```{r}
```
```{r}
table(hr$salary)
table(hr$sales)
```
```{r}
levels(hr$salary)
levels(hr$sales)
```
 

```{r}
hr$salary_le = c("high"=0, "low"=1, "medium"=2)[as.character(hr$salary)]
hr$sales_le = c("accounting"=0, "hr"=1, "IT"=2, "management"=3,  "marketing"=4,  "product_mng"=5, "RandD"=6, "sales"=7, "support"=8, "technical"=9)[as.character(hr$sales)]
```

```{r}
table(hr$salary_le)
table(hr$sales_le)
```


```{r}
ggpairs(hr, wrap = c(I('.'), outlier.shape = I('.')))
```



# SÃ§Ã£o de GrÃ¡ficos Univariados


# AnÃ¡lise Univariada

### Qual Ã© a estrutura do conjunto de dados?
```{r}
hr %>% 
  count(sales, left) %>% 
  mutate(
    n = comma(n, 0)
  ) %>% 
  spread(left, n) %>% 
  formattable(list(area(T, 2:2) ~ color_tile("white", "orange")), align = 'l')
```
#O principal objetivo é investigar a influência das demais variáveis na decisão de saída de uma pessoa de uma empresa e do seu nível de satisfação.
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}

```
# Verifica se existem valores nulos no conjunto de dados hr

```{r}
cor(hr[,1:8])
```



```{r}
corrplot(cor(hr[,1:8]), method="circle")
```
```{r}
ggplot(hr, aes(x=factor(time_spend_company), ))

```
```{r}
#hr_good_leaving_people <- hr_leaving_people %>% filter(last_evaluation >= 0.70 | time_spend_company >= 4 | number_project > 5)
#nrow(hr_good_leaving_people)

```

```{r}

```

```{r}

```
```{r}

```


```{r}

```

```{r}

```

```{r}

```

```{r}

```
```{r}

```

```{r}

```

```{r}

```
```{r}

```

```{r}

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
```

```{r echo=FALSE, message=FALSE, warning=FALSE}

grafico1 <- ggplot(aes(QT_SEMESTRE_FINANCIADO),  data = fies) + 
  geom_bar(fill="orange") +
  scale_x_continuous(limits = c(4, 12), breaks = seq(4,12,1)) +
  labs(title="Distribuição semestre financiado", 
       y="Total", 
       x= "Semestre Financiado")

grafico2 <- ggplot(aes(VL_MENSALIDADE ), data = fies) + 
  geom_histogram(fill="orange",
                 aes(y =..density..)) +
  scale_x_log10() +
  geom_density(col=2) + 
  labs(title="Distribuição mensalidade", 
       y="Total", 
       x= "Valor mensalidade - log10")

grafico3 <- ggplot(aes(fies$VL_PERC_FINANCIAMENTO),  data = fies) + 
  geom_histogram(fill = I("orange"))+
  scale_x_continuous(limits = c(40, 110), breaks = seq(40,110,10)) +
  labs(title="Distribuição percentual Financiado", 
         y="Total", 
         x= "% Financiado")

grid.arrange(grafico1, grafico2, grafico3, nrow=3)
```

### Conhecendo os benefíciarios do FIES
```{r}
grafico1 <- ggplot(aes(DS_SEXO),  data = fies) + 
  geom_bar(fill="blue") +
  #scale_x_continuous(limits = c(4, 12), breaks = seq(4,12,1)) +
  labs(title="Homens/Mulheres", 
       y="Total", 
       x= "Semestre Financiado")

grafico2 <- ggplot(aes(DS_ESTADO_CIVIL), data = fies, colours=DS_SEXO) + 
  geom_bar(fill="blue") +
  #geom_density(col=2) + 
  labs(title="Estado civil", 
       y="Total", 
       x= "Valor mensalidade - log10")

grafico3 <- ggplot(aes(fies$ST_ENSINO_MEDIO_ESCOLA_PUBLICA),  data = fies) + 
  geom_bar(fill = I("blue"))+
  #scale_x_continuous(limits = c(40, 110), breaks = seq(40,110,10)) +
  labs(title="Vindo de escola pública?", 
         y="Total", 
         x= "S: Sim, N: Não, P: Parcial")

grafico4 <- ggplot(aes(IDADE),  data = fies) + 
  geom_histogram(fill="blue",
           aes(y =..density..)) +
  scale_x_continuous(limits = c(15, 60), breaks = seq(15,60,5)) +
  geom_density(col=2) + 
  labs(title="Distribuição semestre financiado", 
       y="Total", 
       x= "Semestre Financiado")

grid.arrange(grafico1, grafico2, grafico3, grafico4, ncol=2, nrow=2,  heights=1:2, widths=1:2)

```
```{r}

```

```{r}

```


```{r}
ggplot(aes(x=DS_ESTADO_CIVIL , fill=DS_SEXO ),
       data = fies) + geom_bar()
```

```{r}
table(hr$left)
by(hr$satisfaction_level, hr$left, summary)

```

### Quais sÃ£o os principais atributos de interesse deste conjunto de dados?

### Quais outros atributos vocÃª acha que podem lhe auxiliar na investigaÃ§Ã£o destes atributos de interesse?

### VocÃª criou novas variÃ¡veis a partir dos atributos existentes no conjunto de dados?

### Dos atributos investigados, distribuiÃ§Ãµes incomuns foram encontradas? VocÃª aplicou operaÃ§Ãµes nos dados para limpÃ¡-los, ajustÃ¡-los ou mudar a forma dos dados? Se sim, por quÃª?



# SeÃ§Ã£o de GrÃ¡ficos Bivariados
```{r echo=FALSE, Bivariate_Plots}

```

# AnÃ¡lise Bivariada

```{r}
with(hr, cor.test(salary_le, satisfaction_level, method = 'pearson'))
```


### Discuta sobre alguns dos relacionamentos observados nesta parte da investigaÃ§Ã£o. Como os atributos de interesse variaram no conjunto de dados?

### VocÃª observou algum relacionamento interessante entre os outros atributos (os que nÃ£o sÃ£o de interesse)?

### Qual foi o relacionamento mais forte encontrado?




# SeÃ§Ã£o de GrÃ¡ficos Multivariados

```{r echo=FALSE, Multivariate_Plots}

```

# AnÃ¡lise Multivariada

### Discuta sobre os relacionamentos observados nesta parte da investigaÃ§Ã£o. Quais atributos que fortaleceram os demais na observaÃ§Ã£o das variÃ¡veis de interesse?

### InteraÃ§Ãµes surpreendentes e/ou interessantes foram encontradas entre os atributos?

### OPCIONAL: Modelos foram criados usando este conjunto de dados? Discuta sobre os pontos fortes e as limitaÃ§Ãµes do seu modelo.

------

# GrÃ¡ficos Finais e SumÃ¡rio

### Primeiro GrÃ¡fico
```{r echo=FALSE, Plot_One}

```

### DescriÃ§Ã£o do Primeiro GrÃ¡fico


### Segundo GrÃ¡fico
```{r echo=FALSE, Plot_Two}

```

### DescriÃ§Ã£o do Segundo GrÃ¡fico


### Terceiro GrÃ¡fico
```{r echo=FALSE, Plot_Three}

```

### DescriÃ§Ã£o do Terceiro GrÃ¡fico

------

# ReflexÃ£o
http://stackoverflow.com/questions/1260965/developing-geographic-thematic-maps-with-r

